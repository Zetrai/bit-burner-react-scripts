export async function main(ns) {
    ns.tprint('------------------------------------');
    ns.tprint('Deploying Scripts...');
    ns.tprint('------------------------------------');
    //getTargetServer
    const programsCount = await getProgramsAndInstall(false, ns);
    const myInfo = {
        level: ns.getHackingLevel(),
        portsUnlocked: programsCount,
        moneyAvailable: await ns.getServerMoneyAvailable('home'),
    };
    const targetServer = await getTargetServer(myInfo, ns);
    await getProgramsAndInstall(targetServer, ns);
    await ns.nuke(targetServer);
    const runningServer = 'home';
    const script = '/scripts/early/hack.js';
    const ramAvailable = ns.getServerMaxRam(runningServer) - ns.getServerUsedRam(runningServer);
    const ramPerThread = ns.getScriptRam(script);
    const threads = Math.floor(ramAvailable / ramPerThread);
    ns.tprint('ramAvailable: ', ramAvailable);
    ns.tprint('ramPerThread: ', ramPerThread);
    ns.tprint('threads: ', threads);
    ns.tprint(threads + ' threads can be runned on ' + runningServer + '.');
    if (threads > 0) {
        ns.tprint('Starting ' +
            script +
            ' on ' +
            targetServer +
            ' with ' +
            runningServer +
            '.');
        ns.exec(script, runningServer, threads, targetServer);
    }
    ns.tprint('------------------------------------');
    ns.tprint('Running hack scripts on other servers...');
    ns.tprint('------------------------------------');
    // Array of all servers that don't need any ports opened
    // to gain root access. These have 16 GB of RAM
    const servers0Port = [
        'sigma-cosmetics',
        'joesguns',
        'nectar-net',
        'hong-fang-tea',
        'harakiri-sushi',
    ];
    // Array of all servers that only need 1 port opened
    // to gain root access. These have 32 GB of RAM
    const servers1Port = ['neo-net', 'zer0', 'max-hardware', 'iron-gym'];
    for (let i = 0; i < servers0Port.length; ++i) {
        const serv = servers0Port[i];
        ns.nuke(serv);
    }
    if (ns.fileExists('BruteSSH.exe')) {
        for (let i = 0; i < servers1Port.length; ++i) {
            const serv = servers1Port[i];
            ns.nuke(serv);
        }
    }
    // ns.tprint('------------------------------------');
    // ns.tprint('Deploying server farm purchase script...');
    // ns.tprint('------------------------------------');
    // script = '/scripts/early/serverFarm.js';
    // ns.exec(script, runningServer, threads, targetServer);
}
export async function getProgramsAndInstall(installCheck, ns) {
    if (!installCheck) {
        let count = 1; //BruteSSH.exe is always installed due to the augmentation
        if (ns.fileExists('FTPCrack.exe', 'home'))
            count++;
        if (ns.fileExists('relaySMTP.exe', 'home'))
            count++;
        if (ns.fileExists('HTTPWorm.exe', 'home'))
            count++;
        if (ns.fileExists('SQLInject.exe', 'home'))
            count++;
        return count;
    }
    if (ns.fileExists('BruteSSH.exe', 'home'))
        ns.brutessh(installCheck);
    if (ns.fileExists('FTPCrack.exe', 'home'))
        ns.ftpcrack(installCheck);
    if (ns.fileExists('relaySMTP.exe', 'home'))
        ns.relaysmtp(installCheck);
    if (ns.fileExists('HTTPWorm.exe', 'home'))
        ns.httpworm(installCheck);
    if (ns.fileExists('SQLInject.exe', 'home'))
        ns.sqlinject(installCheck);
    return;
}
export async function getTargetServer(myInfo, ns) {
    let target = 'foodnstuff';
    if (myInfo.level == 1) {
        return 'foodnstuff';
    }
    else if ((myInfo.level > 40 && myInfo.level < 100) ||
        myInfo.portsUnlocked == 1) {
        target = 'harakiri-sushi';
    }
    else if (myInfo.portsUnlocked == 2 ||
        (myInfo.portsUnlocked > 2 && myInfo.level < 500)) {
        if (myInfo.level < 292)
            target = 'phantasy';
        else
            target = 'phantasy';
    }
    else if (myInfo.portsUnlocked == 3 ||
        (myInfo.portsUnlocked > 3 && myInfo.level < 800)) {
        target = 'phantasy';
    }
    else if (myInfo.portsUnlocked == 4 ||
        (myInfo.portsUnlocked > 4 && myInfo.level < 900)) {
        target = 'phantasy';
    }
    else if (myInfo.portsUnlocked == 5) {
        target = 'phantasy';
    }
    ns.tprint('Target Server : ' + target);
    return target;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3RhcnR1cFNjcmlwdC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9zY3JpcHRzL2Vhcmx5L3N0YXJ0dXBTY3JpcHQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBR0EsTUFBTSxDQUFDLEtBQUssVUFBVSxJQUFJLENBQUMsRUFBTTtJQUMvQixFQUFFLENBQUMsTUFBTSxDQUFDLHNDQUFzQyxDQUFDLENBQUM7SUFDbEQsRUFBRSxDQUFDLE1BQU0sQ0FBQyxzQkFBc0IsQ0FBQyxDQUFDO0lBQ2xDLEVBQUUsQ0FBQyxNQUFNLENBQUMsc0NBQXNDLENBQUMsQ0FBQztJQUNsRCxpQkFBaUI7SUFDakIsTUFBTSxhQUFhLEdBQUcsTUFBTSxxQkFBcUIsQ0FBQyxLQUFLLEVBQUUsRUFBRSxDQUFDLENBQUM7SUFDN0QsTUFBTSxNQUFNLEdBQUc7UUFDYixLQUFLLEVBQUUsRUFBRSxDQUFDLGVBQWUsRUFBRTtRQUMzQixhQUFhLEVBQUUsYUFBYTtRQUM1QixjQUFjLEVBQUUsTUFBTSxFQUFFLENBQUMsdUJBQXVCLENBQUMsTUFBTSxDQUFDO0tBQ3pELENBQUM7SUFDRixNQUFNLFlBQVksR0FBRyxNQUFNLGVBQWUsQ0FBQyxNQUFNLEVBQUUsRUFBRSxDQUFDLENBQUM7SUFDdkQsTUFBTSxxQkFBcUIsQ0FBQyxZQUFZLEVBQUUsRUFBRSxDQUFDLENBQUM7SUFDOUMsTUFBTSxFQUFFLENBQUMsSUFBSSxDQUFDLFlBQVksQ0FBQyxDQUFDO0lBRTVCLE1BQU0sYUFBYSxHQUFHLE1BQU0sQ0FBQztJQUM3QixNQUFNLE1BQU0sR0FBRyx3QkFBd0IsQ0FBQztJQUV4QyxNQUFNLFlBQVksR0FDaEIsRUFBRSxDQUFDLGVBQWUsQ0FBQyxhQUFhLENBQUMsR0FBRyxFQUFFLENBQUMsZ0JBQWdCLENBQUMsYUFBYSxDQUFDLENBQUM7SUFDekUsTUFBTSxZQUFZLEdBQUcsRUFBRSxDQUFDLFlBQVksQ0FBQyxNQUFNLENBQUMsQ0FBQztJQUM3QyxNQUFNLE9BQU8sR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLFlBQVksR0FBRyxZQUFZLENBQUMsQ0FBQztJQUN4RCxFQUFFLENBQUMsTUFBTSxDQUFDLGdCQUFnQixFQUFFLFlBQVksQ0FBQyxDQUFDO0lBQzFDLEVBQUUsQ0FBQyxNQUFNLENBQUMsZ0JBQWdCLEVBQUUsWUFBWSxDQUFDLENBQUM7SUFDMUMsRUFBRSxDQUFDLE1BQU0sQ0FBQyxXQUFXLEVBQUUsT0FBTyxDQUFDLENBQUM7SUFFaEMsRUFBRSxDQUFDLE1BQU0sQ0FBQyxPQUFPLEdBQUcsNEJBQTRCLEdBQUcsYUFBYSxHQUFHLEdBQUcsQ0FBQyxDQUFDO0lBRXhFLElBQUksT0FBTyxHQUFHLENBQUMsRUFBRTtRQUNmLEVBQUUsQ0FBQyxNQUFNLENBQ1AsV0FBVztZQUNULE1BQU07WUFDTixNQUFNO1lBQ04sWUFBWTtZQUNaLFFBQVE7WUFDUixhQUFhO1lBQ2IsR0FBRyxDQUNOLENBQUM7UUFDRixFQUFFLENBQUMsSUFBSSxDQUFDLE1BQU0sRUFBRSxhQUFhLEVBQUUsT0FBTyxFQUFFLFlBQVksQ0FBQyxDQUFDO0tBQ3ZEO0lBQ0QsRUFBRSxDQUFDLE1BQU0sQ0FBQyxzQ0FBc0MsQ0FBQyxDQUFDO0lBQ2xELEVBQUUsQ0FBQyxNQUFNLENBQUMsMENBQTBDLENBQUMsQ0FBQztJQUN0RCxFQUFFLENBQUMsTUFBTSxDQUFDLHNDQUFzQyxDQUFDLENBQUM7SUFFbEQsd0RBQXdEO0lBQ3hELCtDQUErQztJQUMvQyxNQUFNLFlBQVksR0FBRztRQUNuQixpQkFBaUI7UUFDakIsVUFBVTtRQUNWLFlBQVk7UUFDWixlQUFlO1FBQ2YsZ0JBQWdCO0tBQ2pCLENBQUM7SUFFRixvREFBb0Q7SUFDcEQsK0NBQStDO0lBQy9DLE1BQU0sWUFBWSxHQUFHLENBQUMsU0FBUyxFQUFFLE1BQU0sRUFBRSxjQUFjLEVBQUUsVUFBVSxDQUFDLENBQUM7SUFDckUsS0FBSyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLFlBQVksQ0FBQyxNQUFNLEVBQUUsRUFBRSxDQUFDLEVBQUU7UUFDNUMsTUFBTSxJQUFJLEdBQUcsWUFBWSxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQzdCLEVBQUUsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7S0FDZjtJQUNELElBQUksRUFBRSxDQUFDLFVBQVUsQ0FBQyxjQUFjLENBQUMsRUFBRTtRQUNqQyxLQUFLLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsWUFBWSxDQUFDLE1BQU0sRUFBRSxFQUFFLENBQUMsRUFBRTtZQUM1QyxNQUFNLElBQUksR0FBRyxZQUFZLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDN0IsRUFBRSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztTQUNmO0tBQ0Y7SUFFRCxxREFBcUQ7SUFDckQseURBQXlEO0lBQ3pELHFEQUFxRDtJQUNyRCwyQ0FBMkM7SUFDM0MseURBQXlEO0FBQzNELENBQUM7QUFFRCxNQUFNLENBQUMsS0FBSyxVQUFVLHFCQUFxQixDQUFDLFlBQWlCLEVBQUUsRUFBTTtJQUNuRSxJQUFJLENBQUMsWUFBWSxFQUFFO1FBQ2pCLElBQUksS0FBSyxHQUFHLENBQUMsQ0FBQyxDQUFDLDBEQUEwRDtRQUN6RSxJQUFJLEVBQUUsQ0FBQyxVQUFVLENBQUMsY0FBYyxFQUFFLE1BQU0sQ0FBQztZQUFFLEtBQUssRUFBRSxDQUFDO1FBQ25ELElBQUksRUFBRSxDQUFDLFVBQVUsQ0FBQyxlQUFlLEVBQUUsTUFBTSxDQUFDO1lBQUUsS0FBSyxFQUFFLENBQUM7UUFDcEQsSUFBSSxFQUFFLENBQUMsVUFBVSxDQUFDLGNBQWMsRUFBRSxNQUFNLENBQUM7WUFBRSxLQUFLLEVBQUUsQ0FBQztRQUNuRCxJQUFJLEVBQUUsQ0FBQyxVQUFVLENBQUMsZUFBZSxFQUFFLE1BQU0sQ0FBQztZQUFFLEtBQUssRUFBRSxDQUFDO1FBRXBELE9BQU8sS0FBSyxDQUFDO0tBQ2Q7SUFDRCxJQUFJLEVBQUUsQ0FBQyxVQUFVLENBQUMsY0FBYyxFQUFFLE1BQU0sQ0FBQztRQUFFLEVBQUUsQ0FBQyxRQUFRLENBQUMsWUFBWSxDQUFDLENBQUM7SUFDckUsSUFBSSxFQUFFLENBQUMsVUFBVSxDQUFDLGNBQWMsRUFBRSxNQUFNLENBQUM7UUFBRSxFQUFFLENBQUMsUUFBUSxDQUFDLFlBQVksQ0FBQyxDQUFDO0lBQ3JFLElBQUksRUFBRSxDQUFDLFVBQVUsQ0FBQyxlQUFlLEVBQUUsTUFBTSxDQUFDO1FBQUUsRUFBRSxDQUFDLFNBQVMsQ0FBQyxZQUFZLENBQUMsQ0FBQztJQUN2RSxJQUFJLEVBQUUsQ0FBQyxVQUFVLENBQUMsY0FBYyxFQUFFLE1BQU0sQ0FBQztRQUFFLEVBQUUsQ0FBQyxRQUFRLENBQUMsWUFBWSxDQUFDLENBQUM7SUFDckUsSUFBSSxFQUFFLENBQUMsVUFBVSxDQUFDLGVBQWUsRUFBRSxNQUFNLENBQUM7UUFBRSxFQUFFLENBQUMsU0FBUyxDQUFDLFlBQVksQ0FBQyxDQUFDO0lBRXZFLE9BQU87QUFDVCxDQUFDO0FBRUQsTUFBTSxDQUFDLEtBQUssVUFBVSxlQUFlLENBQUMsTUFBVyxFQUFFLEVBQU07SUFDdkQsSUFBSSxNQUFNLEdBQUcsWUFBWSxDQUFDO0lBQzFCLElBQUksTUFBTSxDQUFDLEtBQUssSUFBSSxDQUFDLEVBQUU7UUFDckIsT0FBTyxZQUFZLENBQUM7S0FDckI7U0FBTSxJQUNMLENBQUMsTUFBTSxDQUFDLEtBQUssR0FBRyxFQUFFLElBQUksTUFBTSxDQUFDLEtBQUssR0FBRyxHQUFHLENBQUM7UUFDekMsTUFBTSxDQUFDLGFBQWEsSUFBSSxDQUFDLEVBQ3pCO1FBQ0EsTUFBTSxHQUFHLGdCQUFnQixDQUFDO0tBQzNCO1NBQU0sSUFDTCxNQUFNLENBQUMsYUFBYSxJQUFJLENBQUM7UUFDekIsQ0FBQyxNQUFNLENBQUMsYUFBYSxHQUFHLENBQUMsSUFBSSxNQUFNLENBQUMsS0FBSyxHQUFHLEdBQUcsQ0FBQyxFQUNoRDtRQUNBLElBQUksTUFBTSxDQUFDLEtBQUssR0FBRyxHQUFHO1lBQUUsTUFBTSxHQUFHLFVBQVUsQ0FBQzs7WUFDdkMsTUFBTSxHQUFHLFVBQVUsQ0FBQztLQUMxQjtTQUFNLElBQ0wsTUFBTSxDQUFDLGFBQWEsSUFBSSxDQUFDO1FBQ3pCLENBQUMsTUFBTSxDQUFDLGFBQWEsR0FBRyxDQUFDLElBQUksTUFBTSxDQUFDLEtBQUssR0FBRyxHQUFHLENBQUMsRUFDaEQ7UUFDQSxNQUFNLEdBQUcsVUFBVSxDQUFDO0tBQ3JCO1NBQU0sSUFDTCxNQUFNLENBQUMsYUFBYSxJQUFJLENBQUM7UUFDekIsQ0FBQyxNQUFNLENBQUMsYUFBYSxHQUFHLENBQUMsSUFBSSxNQUFNLENBQUMsS0FBSyxHQUFHLEdBQUcsQ0FBQyxFQUNoRDtRQUNBLE1BQU0sR0FBRyxVQUFVLENBQUM7S0FDckI7U0FBTSxJQUFJLE1BQU0sQ0FBQyxhQUFhLElBQUksQ0FBQyxFQUFFO1FBQ3BDLE1BQU0sR0FBRyxVQUFVLENBQUM7S0FDckI7SUFDRCxFQUFFLENBQUMsTUFBTSxDQUFDLGtCQUFrQixHQUFHLE1BQU0sQ0FBQyxDQUFDO0lBQ3ZDLE9BQU8sTUFBTSxDQUFDO0FBQ2hCLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyIvKiBlc2xpbnQtZGlzYWJsZSBuby1jb25zdGFudC1jb25kaXRpb24gKi9cclxuaW1wb3J0IHsgTlMgfSBmcm9tICdAbnMnO1xyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIG1haW4obnM6IE5TKTogUHJvbWlzZTx2b2lkPiB7XHJcbiAgbnMudHByaW50KCctLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0nKTtcclxuICBucy50cHJpbnQoJ0RlcGxveWluZyBTY3JpcHRzLi4uJyk7XHJcbiAgbnMudHByaW50KCctLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0nKTtcclxuICAvL2dldFRhcmdldFNlcnZlclxyXG4gIGNvbnN0IHByb2dyYW1zQ291bnQgPSBhd2FpdCBnZXRQcm9ncmFtc0FuZEluc3RhbGwoZmFsc2UsIG5zKTtcclxuICBjb25zdCBteUluZm8gPSB7XHJcbiAgICBsZXZlbDogbnMuZ2V0SGFja2luZ0xldmVsKCksXHJcbiAgICBwb3J0c1VubG9ja2VkOiBwcm9ncmFtc0NvdW50LFxyXG4gICAgbW9uZXlBdmFpbGFibGU6IGF3YWl0IG5zLmdldFNlcnZlck1vbmV5QXZhaWxhYmxlKCdob21lJyksXHJcbiAgfTtcclxuICBjb25zdCB0YXJnZXRTZXJ2ZXIgPSBhd2FpdCBnZXRUYXJnZXRTZXJ2ZXIobXlJbmZvLCBucyk7XHJcbiAgYXdhaXQgZ2V0UHJvZ3JhbXNBbmRJbnN0YWxsKHRhcmdldFNlcnZlciwgbnMpO1xyXG4gIGF3YWl0IG5zLm51a2UodGFyZ2V0U2VydmVyKTtcclxuXHJcbiAgY29uc3QgcnVubmluZ1NlcnZlciA9ICdob21lJztcclxuICBjb25zdCBzY3JpcHQgPSAnL3NjcmlwdHMvZWFybHkvaGFjay5qcyc7XHJcblxyXG4gIGNvbnN0IHJhbUF2YWlsYWJsZSA9XHJcbiAgICBucy5nZXRTZXJ2ZXJNYXhSYW0ocnVubmluZ1NlcnZlcikgLSBucy5nZXRTZXJ2ZXJVc2VkUmFtKHJ1bm5pbmdTZXJ2ZXIpO1xyXG4gIGNvbnN0IHJhbVBlclRocmVhZCA9IG5zLmdldFNjcmlwdFJhbShzY3JpcHQpO1xyXG4gIGNvbnN0IHRocmVhZHMgPSBNYXRoLmZsb29yKHJhbUF2YWlsYWJsZSAvIHJhbVBlclRocmVhZCk7XHJcbiAgbnMudHByaW50KCdyYW1BdmFpbGFibGU6ICcsIHJhbUF2YWlsYWJsZSk7XHJcbiAgbnMudHByaW50KCdyYW1QZXJUaHJlYWQ6ICcsIHJhbVBlclRocmVhZCk7XHJcbiAgbnMudHByaW50KCd0aHJlYWRzOiAnLCB0aHJlYWRzKTtcclxuXHJcbiAgbnMudHByaW50KHRocmVhZHMgKyAnIHRocmVhZHMgY2FuIGJlIHJ1bm5lZCBvbiAnICsgcnVubmluZ1NlcnZlciArICcuJyk7XHJcblxyXG4gIGlmICh0aHJlYWRzID4gMCkge1xyXG4gICAgbnMudHByaW50KFxyXG4gICAgICAnU3RhcnRpbmcgJyArXHJcbiAgICAgICAgc2NyaXB0ICtcclxuICAgICAgICAnIG9uICcgK1xyXG4gICAgICAgIHRhcmdldFNlcnZlciArXHJcbiAgICAgICAgJyB3aXRoICcgK1xyXG4gICAgICAgIHJ1bm5pbmdTZXJ2ZXIgK1xyXG4gICAgICAgICcuJ1xyXG4gICAgKTtcclxuICAgIG5zLmV4ZWMoc2NyaXB0LCBydW5uaW5nU2VydmVyLCB0aHJlYWRzLCB0YXJnZXRTZXJ2ZXIpO1xyXG4gIH1cclxuICBucy50cHJpbnQoJy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLScpO1xyXG4gIG5zLnRwcmludCgnUnVubmluZyBoYWNrIHNjcmlwdHMgb24gb3RoZXIgc2VydmVycy4uLicpO1xyXG4gIG5zLnRwcmludCgnLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tJyk7XHJcblxyXG4gIC8vIEFycmF5IG9mIGFsbCBzZXJ2ZXJzIHRoYXQgZG9uJ3QgbmVlZCBhbnkgcG9ydHMgb3BlbmVkXHJcbiAgLy8gdG8gZ2FpbiByb290IGFjY2Vzcy4gVGhlc2UgaGF2ZSAxNiBHQiBvZiBSQU1cclxuICBjb25zdCBzZXJ2ZXJzMFBvcnQgPSBbXHJcbiAgICAnc2lnbWEtY29zbWV0aWNzJyxcclxuICAgICdqb2VzZ3VucycsXHJcbiAgICAnbmVjdGFyLW5ldCcsXHJcbiAgICAnaG9uZy1mYW5nLXRlYScsXHJcbiAgICAnaGFyYWtpcmktc3VzaGknLFxyXG4gIF07XHJcblxyXG4gIC8vIEFycmF5IG9mIGFsbCBzZXJ2ZXJzIHRoYXQgb25seSBuZWVkIDEgcG9ydCBvcGVuZWRcclxuICAvLyB0byBnYWluIHJvb3QgYWNjZXNzLiBUaGVzZSBoYXZlIDMyIEdCIG9mIFJBTVxyXG4gIGNvbnN0IHNlcnZlcnMxUG9ydCA9IFsnbmVvLW5ldCcsICd6ZXIwJywgJ21heC1oYXJkd2FyZScsICdpcm9uLWd5bSddO1xyXG4gIGZvciAobGV0IGkgPSAwOyBpIDwgc2VydmVyczBQb3J0Lmxlbmd0aDsgKytpKSB7XHJcbiAgICBjb25zdCBzZXJ2ID0gc2VydmVyczBQb3J0W2ldO1xyXG4gICAgbnMubnVrZShzZXJ2KTtcclxuICB9XHJcbiAgaWYgKG5zLmZpbGVFeGlzdHMoJ0JydXRlU1NILmV4ZScpKSB7XHJcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNlcnZlcnMxUG9ydC5sZW5ndGg7ICsraSkge1xyXG4gICAgICBjb25zdCBzZXJ2ID0gc2VydmVyczFQb3J0W2ldO1xyXG4gICAgICBucy5udWtlKHNlcnYpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLy8gbnMudHByaW50KCctLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0nKTtcclxuICAvLyBucy50cHJpbnQoJ0RlcGxveWluZyBzZXJ2ZXIgZmFybSBwdXJjaGFzZSBzY3JpcHQuLi4nKTtcclxuICAvLyBucy50cHJpbnQoJy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLScpO1xyXG4gIC8vIHNjcmlwdCA9ICcvc2NyaXB0cy9lYXJseS9zZXJ2ZXJGYXJtLmpzJztcclxuICAvLyBucy5leGVjKHNjcmlwdCwgcnVubmluZ1NlcnZlciwgdGhyZWFkcywgdGFyZ2V0U2VydmVyKTtcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFByb2dyYW1zQW5kSW5zdGFsbChpbnN0YWxsQ2hlY2s6IGFueSwgbnM6IE5TKSB7XHJcbiAgaWYgKCFpbnN0YWxsQ2hlY2spIHtcclxuICAgIGxldCBjb3VudCA9IDE7IC8vQnJ1dGVTU0guZXhlIGlzIGFsd2F5cyBpbnN0YWxsZWQgZHVlIHRvIHRoZSBhdWdtZW50YXRpb25cclxuICAgIGlmIChucy5maWxlRXhpc3RzKCdGVFBDcmFjay5leGUnLCAnaG9tZScpKSBjb3VudCsrO1xyXG4gICAgaWYgKG5zLmZpbGVFeGlzdHMoJ3JlbGF5U01UUC5leGUnLCAnaG9tZScpKSBjb3VudCsrO1xyXG4gICAgaWYgKG5zLmZpbGVFeGlzdHMoJ0hUVFBXb3JtLmV4ZScsICdob21lJykpIGNvdW50Kys7XHJcbiAgICBpZiAobnMuZmlsZUV4aXN0cygnU1FMSW5qZWN0LmV4ZScsICdob21lJykpIGNvdW50Kys7XHJcblxyXG4gICAgcmV0dXJuIGNvdW50O1xyXG4gIH1cclxuICBpZiAobnMuZmlsZUV4aXN0cygnQnJ1dGVTU0guZXhlJywgJ2hvbWUnKSkgbnMuYnJ1dGVzc2goaW5zdGFsbENoZWNrKTtcclxuICBpZiAobnMuZmlsZUV4aXN0cygnRlRQQ3JhY2suZXhlJywgJ2hvbWUnKSkgbnMuZnRwY3JhY2soaW5zdGFsbENoZWNrKTtcclxuICBpZiAobnMuZmlsZUV4aXN0cygncmVsYXlTTVRQLmV4ZScsICdob21lJykpIG5zLnJlbGF5c210cChpbnN0YWxsQ2hlY2spO1xyXG4gIGlmIChucy5maWxlRXhpc3RzKCdIVFRQV29ybS5leGUnLCAnaG9tZScpKSBucy5odHRwd29ybShpbnN0YWxsQ2hlY2spO1xyXG4gIGlmIChucy5maWxlRXhpc3RzKCdTUUxJbmplY3QuZXhlJywgJ2hvbWUnKSkgbnMuc3FsaW5qZWN0KGluc3RhbGxDaGVjayk7XHJcblxyXG4gIHJldHVybjtcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFRhcmdldFNlcnZlcihteUluZm86IGFueSwgbnM6IE5TKSB7XHJcbiAgbGV0IHRhcmdldCA9ICdmb29kbnN0dWZmJztcclxuICBpZiAobXlJbmZvLmxldmVsID09IDEpIHtcclxuICAgIHJldHVybiAnZm9vZG5zdHVmZic7XHJcbiAgfSBlbHNlIGlmIChcclxuICAgIChteUluZm8ubGV2ZWwgPiA0MCAmJiBteUluZm8ubGV2ZWwgPCAxMDApIHx8XHJcbiAgICBteUluZm8ucG9ydHNVbmxvY2tlZCA9PSAxXHJcbiAgKSB7XHJcbiAgICB0YXJnZXQgPSAnaGFyYWtpcmktc3VzaGknO1xyXG4gIH0gZWxzZSBpZiAoXHJcbiAgICBteUluZm8ucG9ydHNVbmxvY2tlZCA9PSAyIHx8XHJcbiAgICAobXlJbmZvLnBvcnRzVW5sb2NrZWQgPiAyICYmIG15SW5mby5sZXZlbCA8IDUwMClcclxuICApIHtcclxuICAgIGlmIChteUluZm8ubGV2ZWwgPCAyOTIpIHRhcmdldCA9ICdwaGFudGFzeSc7XHJcbiAgICBlbHNlIHRhcmdldCA9ICdwaGFudGFzeSc7XHJcbiAgfSBlbHNlIGlmIChcclxuICAgIG15SW5mby5wb3J0c1VubG9ja2VkID09IDMgfHxcclxuICAgIChteUluZm8ucG9ydHNVbmxvY2tlZCA+IDMgJiYgbXlJbmZvLmxldmVsIDwgODAwKVxyXG4gICkge1xyXG4gICAgdGFyZ2V0ID0gJ3BoYW50YXN5JztcclxuICB9IGVsc2UgaWYgKFxyXG4gICAgbXlJbmZvLnBvcnRzVW5sb2NrZWQgPT0gNCB8fFxyXG4gICAgKG15SW5mby5wb3J0c1VubG9ja2VkID4gNCAmJiBteUluZm8ubGV2ZWwgPCA5MDApXHJcbiAgKSB7XHJcbiAgICB0YXJnZXQgPSAncGhhbnRhc3knO1xyXG4gIH0gZWxzZSBpZiAobXlJbmZvLnBvcnRzVW5sb2NrZWQgPT0gNSkge1xyXG4gICAgdGFyZ2V0ID0gJ3BoYW50YXN5JztcclxuICB9XHJcbiAgbnMudHByaW50KCdUYXJnZXQgU2VydmVyIDogJyArIHRhcmdldCk7XHJcbiAgcmV0dXJuIHRhcmdldDtcclxufVxyXG4iXX0=